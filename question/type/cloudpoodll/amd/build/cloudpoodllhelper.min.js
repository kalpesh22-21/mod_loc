define(["jquery","core/log","qtype_cloudpoodll/cloudpoodllloader"],function(a,b,c){"use strict";return b.debug("cloudpoodll helper: initialising"),{configs:{},init:function(b){var d={};d.component=b.component,d.data_id=b.data_id,d.inputname=b.inputname,d.transcriber=b.transcriber,d.uploadstate=!1;var e=CSS.escape(d.inputname);d.controls={mediaurl:a("input[name="+e+"mediaurl]"),transcript:a("input[name="+e+"transcript]"),answer:a("input[name="+e+"]")},this.configs[d.data_id]=d;var f=this,g="";c.init(d.data_id,function(a){var b=f.configs[a.id];if(b)switch(a.type){case"recording":"started"===a.action&&(g="");break;case"speech":g+="  "+a.capturedspeech,b.controls.transcript.val(g),b.controls.answer.val(g);break;case"awaitingprocessing":"posted"!=b.uploadstate&&(b.controls.mediaurl.val(a.mediaurl),b.controls.answer.val(a.mediaurl)),b.uploadstate="posted";break;case"error":alert("PROBLEM: "+a.message)}})},setup_recorder:function(a){var b="",d=function(c){switch(c.type){case"recording":"started"===c.action&&(b="");break;case"speech":b+="  "+c.capturedspeech,a.controls.transcript.val(b),a.controls.answer.val(b);break;case"awaitingprocessing":"posted"!=a.uploadstate&&(a.controls.mediaurl.val(c.mediaurl),a.controls.answer.val(c.mediaurl)),a.uploadstate="posted";break;case"error":alert("PROBLEM: "+c.message)}},e=c.clone();e.init(a.data_id,d)},register_controls:function(b){var c=CSS.escape(b.inputname);return b.controls={mediaurl:a("input[name="+c+"mediaurl]"),transcript:a("input[name="+c+"transcript]"),answer:a("input[name="+c+"]")},b},register_events:function(a){}}});